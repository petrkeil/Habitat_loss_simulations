---
title: "Simulating whole tree community in 2x2 km window"
author: "Petr Keil"
date: "September 2, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load the libraries and source the functions

```{r}
  library(spatstat)
  source("habitat_loss_functions.R")
```

Load the Thomas model parameters

```{r}
  Thomas.res <- read.csv("../data/BCI_Thomas.csv")
```

## Simulate point patterns with marked species identity

```{r}
  simcom.list <- sim.Thomas.com(Thomas.res, 1:100)
  big.ppp <- merge.simcom.list(simcom.list)
```

## Load the desctruction patterns
```{r}
  branching.loss <- read.loss.owin("../data/loss_matrices/branching.csv")
  branching.rem <- read.remain.owin("../data/loss_matrices/branching.csv")
  outwards.loss <- read.loss.owin("../data/loss_matrices/outwards.csv")
  outwards.rem <- read.remain.owin("../data/loss_matrices/outwards.csv")
```

## Count number of species in the lsot area, in the remaining are, and the total

```{r}
  # Total number of species
  length(unique(big.ppp$marks))

  loss.ppp <- big.ppp[outwards.loss]
  length(unique(loss.ppp$marks)) 

  rem.ppp <- big.ppp[outwards.rem]
  length(unique(rem.ppp$marks)) 

```








