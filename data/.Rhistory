test.sp <- bci[bci$Latin=="Ormosia amazonica",]
#test.sp <- bci[bci$Latin=="Bactris major",]
#test.sp <- bci[bci$Latin=="Ficus popenoei",]
#test.sp <- bci[bci$Latin=="Hybanthus prunifolius",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
W2000 <- as.owin(list(xrange=c(0,2000), yrange=c(0,2000)))
test.pred <- rThomas(test.fit['kappa'],
test.fit['sigma'],
test.fit['mu'],
win=W2000)
plot(test.pred, pch=19, cex=0.3, cols="black", main="Test species")
rect(0,0,1000,500, col="white")
points(test.sp$PX, test.sp$PY, col="red", pch=19, cex=0.3)
rThomas(1,1,1)
c(a=1,b=1)
clusterfit(xy, clusters="Thomas")
test.fit
Thomas <- function(x, y)
{
if(length(x=1)) # in case there is just a single point
{
return(c(kappa=1, sigma=1, mu=1))
}
else
{
W <- as.owin(list(xrange=c(0,1000), yrange=c(0,500)))
xy <- as.ppp(cbind(x, y), W)
fit.xy <- clusterfit(xy, clusters="Thomas")
return(fit.xy$modelpar)
}
}
#test.sp <- bci[bci$Latin=="Acalypha diversifolia",]
test.sp <- bci[bci$Latin=="Ormosia amazonica",]
#test.sp <- bci[bci$Latin=="Bactris major",]
#test.sp <- bci[bci$Latin=="Ficus popenoei",]
#test.sp <- bci[bci$Latin=="Hybanthus prunifolius",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
W2000 <- as.owin(list(xrange=c(0,2000), yrange=c(0,2000)))
test.pred <- rThomas(test.fit['kappa'],
test.fit['sigma'],
test.fit['mu'],
win=W2000)
plot(test.pred, pch=19, cex=0.3, cols="black", main="Test species")
rect(0,0,1000,500, col="white")
points(test.sp$PX, test.sp$PY, col="red", pch=19, cex=0.3)
Thomas <- function(x, y)
{
if(length(x=1)) # in case there is just a single point
{
return(c(kappa=1/(1000*500), sigma=1, mu=1))
}
else
{
W <- as.owin(list(xrange=c(0,1000), yrange=c(0,500)))
xy <- as.ppp(cbind(x, y), W)
fit.xy <- clusterfit(xy, clusters="Thomas")
return(fit.xy$modelpar)
}
}
#test.sp <- bci[bci$Latin=="Acalypha diversifolia",]
test.sp <- bci[bci$Latin=="Ormosia amazonica",]
#test.sp <- bci[bci$Latin=="Bactris major",]
#test.sp <- bci[bci$Latin=="Ficus popenoei",]
#test.sp <- bci[bci$Latin=="Hybanthus prunifolius",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
W2000 <- as.owin(list(xrange=c(0,2000), yrange=c(0,2000)))
test.pred <- rThomas(test.fit['kappa'],
test.fit['sigma'],
test.fit['mu'],
win=W2000)
plot(test.pred, pch=19, cex=0.3, cols="black", main="Test species")
rect(0,0,1000,500, col="white")
points(test.sp$PX, test.sp$PY, col="red", pch=19, cex=0.3)
a <- ddply(.data=bci,
.variables="Latin",
.fun=summarize,
Range=Thomas(PX, PY))
a
a <- dlply(.data=bci,
.variables="Latin",
.fun=summarize,
Range=Thomas(PX, PY))
a
#test.sp <- bci[bci$Latin=="Acalypha diversifolia",]
#test.sp <- bci[bci$Latin=="Ormosia amazonica",]
test.sp <- bci[bci$Latin=="Bactris major",]
#test.sp <- bci[bci$Latin=="Ficus popenoei",]
#test.sp <- bci[bci$Latin=="Hybanthus prunifolius",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
W2000 <- as.owin(list(xrange=c(0,2000), yrange=c(0,2000)))
test.pred <- rThomas(test.fit['kappa'],
test.fit['sigma'],
test.fit['mu'],
win=W2000)
plot(test.pred, pch=19, cex=0.3, cols="black", main="Test species")
rect(0,0,1000,500, col="white")
points(test.sp$PX, test.sp$PY, col="red", pch=19, cex=0.3)
Thomas <- function(x, y)
{
if(length(x==1)) # in case there is just a single point
{
return(c(kappa=1/(1000*500), sigma=1, mu=1))
}
else
{
W <- as.owin(list(xrange=c(0,1000), yrange=c(0,500)))
xy <- as.ppp(cbind(x, y), W)
fit.xy <- clusterfit(xy, clusters="Thomas")
return(fit.xy$modelpar)
}
}
a <- dlply(.data=bci,
.variables="Latin",
.fun=summarize,
Range=Thomas(PX, PY))
a
abundances <- ddply(.data=bci,
.variables="Latin",
.fun=summarize,
Range=length(Latin))
hist(abundances[,2])
hist(log(abundances[,2]))
hist(log(abundances[,2]), col="grey")
a <- dlply(.data=bci,
.variables="Latin",
.fun=summarize,
Thomas(PX, PY))
a
a <- ddply(.data=bci,
.variables="Latin",
.fun=summarize,
Thomas(PX, PY))
a
a[1,2]
a[1,2]* 1000000
abundances
Thomas.multispec <- list()
list()
a <- list()
a
a[2] <- 1
a
Thomas.multispec <- list()
for(i in 1:nrow(abundances))
{
spec <- abundances[i, 'Latin']
print(spec)
}
Thomas.multispec <- list()
for(i in 1:nrow(abundances))
{
spec <- as.character(abundances[i, 'Latin']      )
print(spec)
}
Thomas.multispec <- list()
for(i in 1:nrow(abundances))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.multispec[[i]] <- Thomas(bci.sub$PX, bci.sub$PY)
print(spec)
}
Thomas.multispec
nrow(abundances)
length(unique(bci$Latin))
nrow(bci)
i = 1
spec <- as.character(abundances[i, 'Latin'])
spec
bci.sub <- bci[bci$Latin==spec,]
bci.sub
Thomas.multispec <- list()
Thomas.multispec[[i]] <- Thomas(bci.sub$PX, bci.sub$PY)
Thomas(bci.sub$PX, bci.sub$PY)
i=2
Thomas(bci.sub$PX, bci.sub$PY)
a = Thomas(bci.sub$PX, bci.sub$PY)
a
a*10000000
a
a[1]*10000000
a[1]*100000000
a[2]*100000000
a[2]*1000000000
i=3
bci.sub <- bci[bci$Latin==spec,]
Thomas.multispec[[i]] <- Thomas(bci.sub$PX, bci.sub$PY)
Thomas(bci.sub$PX, bci.sub$PY)
test.sp <- bci[bci$Latin=="Bactris major",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
test.fit
#test.sp <- bci[bci$Latin=="Acalypha diversifolia",]
#test.sp <- bci[bci$Latin=="Ormosia amazonica",]
test.sp <- bci[bci$Latin=="Bactris major",]
#test.sp <- bci[bci$Latin=="Ficus popenoei",]
#test.sp <- bci[bci$Latin=="Hybanthus prunifolius",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
W2000 <- as.owin(list(xrange=c(0,2000), yrange=c(0,2000)))
test.pred <- rThomas(test.fit['kappa'],
test.fit['sigma'],
test.fit['mu'],
win=W2000)
plot(test.pred, pch=19, cex=0.3, cols="black", main="Test species")
rect(0,0,1000,500, col="white")
points(test.sp$PX, test.sp$PY, col="red", pch=19, cex=0.3)
#test.sp <- bci[bci$Latin=="Acalypha diversifolia",]
test.sp <- bci[bci$Latin=="Ormosia amazonica",]
#test.sp <- bci[bci$Latin=="Bactris major",]
#test.sp <- bci[bci$Latin=="Ficus popenoei",]
#test.sp <- bci[bci$Latin=="Hybanthus prunifolius",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
W2000 <- as.owin(list(xrange=c(0,2000), yrange=c(0,2000)))
test.pred <- rThomas(test.fit['kappa'],
test.fit['sigma'],
test.fit['mu'],
win=W2000)
plot(test.pred, pch=19, cex=0.3, cols="black", main="Test species")
rect(0,0,1000,500, col="white")
points(test.sp$PX, test.sp$PY, col="red", pch=19, cex=0.3)
test.sp <- bci[bci$Latin=="Acalypha diversifolia",]
#test.sp <- bci[bci$Latin=="Ormosia amazonica",]
#test.sp <- bci[bci$Latin=="Bactris major",]
#test.sp <- bci[bci$Latin=="Ficus popenoei",]
#test.sp <- bci[bci$Latin=="Hybanthus prunifolius",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
W2000 <- as.owin(list(xrange=c(0,2000), yrange=c(0,2000)))
test.pred <- rThomas(test.fit['kappa'],
test.fit['sigma'],
test.fit['mu'],
win=W2000)
plot(test.pred, pch=19, cex=0.3, cols="black", main="Test species")
rect(0,0,1000,500, col="white")
points(test.sp$PX, test.sp$PY, col="red", pch=19, cex=0.3)
Thomas <- function(x, y)
{
if(length(x==1)) # in case there is just a single point
{
return(c(kappa=1/(1000*500), sigma=1, mu=1))
}
else
{
W <- as.owin(list(xrange=c(0,1000), yrange=c(0,500)))
xy <- as.ppp(cbind(x, y), W)
fit.xy <- clusterfit(xy, clusters="Thomas")
return(fit.xy$modelpar)
}
}
test.sp <- bci[bci$Latin=="Acalypha diversifolia",]
#test.sp <- bci[bci$Latin=="Ormosia amazonica",]
#test.sp <- bci[bci$Latin=="Bactris major",]
#test.sp <- bci[bci$Latin=="Ficus popenoei",]
#test.sp <- bci[bci$Latin=="Hybanthus prunifolius",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
W2000 <- as.owin(list(xrange=c(0,2000), yrange=c(0,2000)))
test.pred <- rThomas(test.fit['kappa'],
test.fit['sigma'],
test.fit['mu'],
win=W2000)
plot(test.pred, pch=19, cex=0.3, cols="black", main="Test species")
rect(0,0,1000,500, col="white")
points(test.sp$PX, test.sp$PY, col="red", pch=19, cex=0.3)
Thomas <- function(x, y)
{
if(length(x)==1) # in case there is just a single point
{
return(c(kappa=1/(1000*500), sigma=1, mu=1))
}
else
{
W <- as.owin(list(xrange=c(0,1000), yrange=c(0,500)))
xy <- as.ppp(cbind(x, y), W)
fit.xy <- clusterfit(xy, clusters="Thomas")
return(fit.xy$modelpar)
}
}
test.sp <- bci[bci$Latin=="Acalypha diversifolia",]
#test.sp <- bci[bci$Latin=="Ormosia amazonica",]
#test.sp <- bci[bci$Latin=="Bactris major",]
#test.sp <- bci[bci$Latin=="Ficus popenoei",]
#test.sp <- bci[bci$Latin=="Hybanthus prunifolius",]
test.fit <- Thomas(test.sp$PX, test.sp$PY)
W2000 <- as.owin(list(xrange=c(0,2000), yrange=c(0,2000)))
test.pred <- rThomas(test.fit['kappa'],
test.fit['sigma'],
test.fit['mu'],
win=W2000)
plot(test.pred, pch=19, cex=0.3, cols="black", main="Test species")
rect(0,0,1000,500, col="white")
points(test.sp$PX, test.sp$PY, col="red", pch=19, cex=0.3)
abundances <- ddply(.data=bci,
.variables="Latin",
.fun=summarize,
Range=length(Latin))
hist(log(abundances[,2]), col="grey")
Thomas.multispec <- list()
for(i in 1:nrow(abundances))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.multispec[[i]] <- Thomas(bci.sub$PX, bci.sub$PY)
print(spec)
}
warnings()
Thomas.multispec <- ldply(Thomas.multispec)
Thomas.multispec
Thomas.res <- list()
for(i in 1:nrow(abundances))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Latin="spec", Thomas(bci.sub$PX, bci.sub$PY))
print(spec)
}
Thomas.res  <- ldply(Thomas.res )
Thomas.res
Thomas.res <- list()
for(i in 1:nrow(abundances))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Latin=spec, Thomas(bci.sub$PX, bci.sub$PY))
print(spec)
}
Thomas.res  <- ldply(Thomas.res )
Thomas.res
Thomas.res <- list()
for(i in 1:nrow(abund))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Latin=spec, Thomas(bci.sub$PX, bci.sub$PY))
}
Thomas.res  <- ldply(Thomas.res )
Thomas.res <- merge(Thomas.res, abund, by="Latin")
abund <- ddply(.data=bci,
.variables="Latin",
.fun=summarize,
Range=length(Latin))
Thomas.res <- list()
for(i in 1:nrow(abund))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Latin=spec, Thomas(bci.sub$PX, bci.sub$PY))
}
Thomas.res  <- ldply(Thomas.res )
Thomas.res <- merge(Thomas.res, abund, by="Latin")
Thomas.res
abund <- ddply(.data=bci,
.variables="Latin",
.fun=summarize,
Abund=length(Latin))
Thomas.res <- list()
for(i in 1:nrow(abund))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Latin=spec, Thomas(bci.sub$PX, bci.sub$PY))
}
Thomas.res  <- ldply(Thomas.res )
Thomas.res <- merge(Thomas.res, abund, by="Latin")
Thomas.res <- list()
for(i in 1:nrow(abund))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Latin=spec, Thomas(bci.sub$PX, bci.sub$PY))
}
Thomas.res  <- ldply(Thomas.res )
Thomas.res <- merge(Thomas.res, abund, by="Latin")
Thomas.res
abund <- ddply(.data=bci,
.variables="Latin",
.fun=summarize,
Abundance=length(Latin))
Thomas.res <- list()
for(i in 1:nrow(abund))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Latin=spec, Thomas(bci.sub$PX, bci.sub$PY))
}
Thomas.res  <- ldply(Thomas.res )
Thomas.res <- merge(Thomas.res, abund, by="Latin")
head(Thomas.res)
par(mfrow=c(2,2))
for(i in 2:5)
{
hist(Thomas.res[,i])
}
Homas.res[,2]
Thomas.res[,2]
Thomas.res[,3]
Thomas.res[,4]
head(Thomas.res)
hist(as.numeric(Thomas.res[,i])  )
par(mfrow=c(2,2))
for(i in 2:5)
{
hist(as.numeric(Thomas.res[,i])  )
}
hist(as.numeric(log10(Thomas.res[,i])  ))
par(mfrow=c(2,2))
for(i in 2:5)
{
hist(as.numeric(log10(Thomas.res[,i])  ))
}
par(mfrow=c(2,2))
for(i in 2:5)
{
hist(as.numeric(log10(Thomas.res[,i])  ))
}
par(mfrow=c(2,2))
for(i in 2:5)
{
hist(as.numeric(log(Thomas.res[,i])  ))
}
par(mfrow=c(2,2))
for(i in 2:5)
{
hist(log(as.numeric(Thomas.res[,i])))
}
Thomas.res <- as.numeric(Thomas.res[,2:5])
Thomas.res <- list()
for(i in 1:nrow(abund))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Latin=spec, Thomas(bci.sub$PX, bci.sub$PY))
}
Thomas.res <- ldply(Thomas.res)
Thomas.res <- as.numeric(Thomas.res[,2:5])
Thomas.res <- merge(Thomas.res, abund, by="Latin")
Thomas.res
Thomas.res <- as.numeric(Thomas.res[,2:5])
Thomas.res <- merge(Thomas.res, abund, by="Latin")
Thomas.res <- as.numeric(Thomas.res[,2:5])
Thomas.res[,2:5]
abund <- ddply(.data=bci,
.variables="Latin",
.fun=summarize,
Abundance=length(Latin))
Thomas.res <- list()
for(i in 1:nrow(abund))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Latin=spec, Thomas(bci.sub$PX, bci.sub$PY))
}
Thomas.res <- ldply(Thomas.res)
Thomas.res <- merge(Thomas.res, abund, by="Latin")
Thomas.res <- as.numeric(Thomas.res[,2:5])
head(Thomas.res)
Thomas.res <- as.numeric(Thomas.res[,2:5])
class(Thomas.res)
Thomas.res[,2:5]
Thomas.res <- list()
for(i in 1:nrow(abund))
{
spec <- as.character(abundances[i, 'Latin'])
bci.sub <- bci[bci$Latin==spec,]
Thomas.res[[i]] <- c(Thomas(bci.sub$PX, bci.sub$PY))
}
Thomas.res <- ldply(Thomas.res)
Thomas.res <- data.frame(abund, Thomas.res)
par(mfrow=c(2,2))
hist(log10(Thomas.res$abund))
class(Thomas.res$Abundance)
hist(log10(Thomas.res$Abundance))
head(Thomas.res)
par(mfrow=c(2,2))
hist(log10(Thomas.res$Abundance))
hist(log10(Thomas.res$kappa))
hist(log10(Thomas.res$sigma))
hist(log10(Thomas.res$mu))
hist(log10(Thomas.res$Abundance), col="grey")
par(mfrow=c(2,2))
hist(log10(Thomas.res$Abundance), col="grey", main="", xlab="Abundance")
hist(log10(Thomas.res$kappa), col="grey", main="", xlab="kappa")
hist(log10(Thomas.res$sigma), col="grey", main="", xlab="sigma")
hist(log10(Thomas.res$mu), col="grey", main="", xlab="mu")
par(mfrow=c(2,2))
hist(log10(Thomas.res$Abundance), col="grey", main="", xlab="Abundance", breaks=30)
hist(log10(Thomas.res$kappa), col="grey", main="", xlab="kappa")
hist(log10(Thomas.res$sigma), col="grey", main="", xlab="sigma")
hist(log10(Thomas.res$mu), col="grey", main="", xlab="mu")
par(mfrow=c(2,2))
hist(log10(Thomas.res$Abundance), col="grey", main="", xlab="Abundance", breaks=30)
hist(log10(Thomas.res$kappa), col="grey", main="", xlab="kappa", breaks=30)
hist(log10(Thomas.res$sigma), col="grey", main="", xlab="sigma", breaks=30)
hist(log10(Thomas.res$mu), col="grey", main="", xlab="mu", breaks=30)
par(mfrow=c(2,2), mai=c(0.5, 0.5, 0.1, 0.1))
hist(log10(Thomas.res$Abundance), col="grey", main="", xlab="Abundance", breaks=30)
hist(log10(Thomas.res$kappa), col="grey", main="", xlab="kappa", breaks=30)
hist(log10(Thomas.res$sigma), col="grey", main="", xlab="sigma", breaks=30)
hist(log10(Thomas.res$mu), col="grey", main="", xlab="mu", breaks=30)
par(mfrow=c(2,2), mai=c(0.8, 0.8, 0.1, 0.1))
hist(log10(Thomas.res$Abundance), col="grey", main="", xlab="Abundance", breaks=30)
hist(log10(Thomas.res$kappa), col="grey", main="", xlab="kappa", breaks=30)
hist(log10(Thomas.res$sigma), col="grey", main="", xlab="sigma", breaks=30)
hist(log10(Thomas.res$mu), col="grey", main="", xlab="mu", breaks=30)
par(mfrow=c(2,2), mai=c(0.8, 0.8, 0.1, 0.1))
hist(log10(Thomas.res$Abundance), col="grey", main="",
xlab="log10 Abundance", breaks=30)
hist(log10(Thomas.res$kappa), col="grey", main="",
xlab="log10 kappa", breaks=30)
hist(log10(Thomas.res$sigma), col="grey", main="",
xlab="log10 sigma", breaks=30)
hist(log10(Thomas.res$mu), col="grey", main="",
xlab="log10 mu", breaks=30)
pairs(Thomas.res)
pairs(log10(Thomas.res[,2:5]))
